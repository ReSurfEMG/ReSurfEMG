<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>resurfemg.preprocessing.ecg_removal module &#8212; resurfemg 1.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css?v=279e0f84" />
    <script src="_static/documentation_options.js?v=292eb321"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="resurfemg.preprocessing.envelope module" href="resurfemg.preprocessing.envelope.html" />
    <link rel="prev" title="resurfemg.preprocessing package" href="resurfemg.preprocessing.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="resurfemg.preprocessing.envelope.html" title="resurfemg.preprocessing.envelope module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="resurfemg.preprocessing.html" title="resurfemg.preprocessing package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">resurfemg 1.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >resurfemg</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="resurfemg.html" >resurfemg package</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="resurfemg.preprocessing.html" accesskey="U">resurfemg.preprocessing package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">resurfemg.preprocessing.ecg_removal module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-resurfemg.preprocessing.ecg_removal">
<span id="resurfemg-preprocessing-ecg-removal-module"></span><h1>resurfemg.preprocessing.ecg_removal module<a class="headerlink" href="#module-resurfemg.preprocessing.ecg_removal" title="Link to this heading">¶</a></h1>
<p>Copyright 2022 Netherlands eScience Center and University of Twente
Licensed under the Apache License, version 2.0. See LICENSE for details.</p>
<p>This file contains functions to eliminate ECG artifacts from EMG arrays.</p>
<dl class="py function">
<dt class="sig sig-object py" id="resurfemg.preprocessing.ecg_removal.detect_ecg_peaks">
<span class="sig-prename descclassname"><span class="pre">resurfemg.preprocessing.ecg_removal.</span></span><span class="sig-name descname"><span class="pre">detect_ecg_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecg_raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_width_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resurfemg.preprocessing.ecg_removal.detect_ecg_peaks" title="Link to this definition">¶</a></dt>
<dd><section id="detect-ecg-peaks-in-emg-signal">
<h2>Detect ECG peaks in EMG signal.<a class="headerlink" href="#detect-ecg-peaks-in-emg-signal" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">param ecg_raw<span class="colon">:</span></dt>
<dd class="field-odd"><p>ecg signals to detect the ECG peaks in.</p>
</dd>
<dt class="field-even">type ecg_raw<span class="colon">:</span></dt>
<dd class="field-even"><p>~numpy.ndarray</p>
</dd>
<dt class="field-odd">param emg_raw<span class="colon">:</span></dt>
<dd class="field-odd"><p>emg signals to gate</p>
</dd>
<dt class="field-even">type emg_raw<span class="colon">:</span></dt>
<dd class="field-even"><p>~numpy.ndarray</p>
</dd>
<dt class="field-odd">param fs<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sampling rate of the emg signals.</p>
</dd>
<dt class="field-even">type fs<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">param peak_fraction<span class="colon">:</span></dt>
<dd class="field-odd"><p>ECG peaks amplitude threshold relative to the
specified fraction of the min-max values in the ECG signal</p>
</dd>
<dt class="field-even">type peak_fraction<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">param peak_width_s<span class="colon">:</span></dt>
<dd class="field-odd"><p>ECG peaks width threshold in samples.</p>
</dd>
<dt class="field-even">type peak_width_s<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">param peak_distance<span class="colon">:</span></dt>
<dd class="field-odd"><p>Minimum time between ECG peaks in samples.</p>
</dd>
<dt class="field-even">type peak_distance<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">param filter<span class="colon">:</span></dt>
<dd class="field-odd"><p>Bandpass filter the ecg_raw between 1-500 Hz before peak
detection.</p>
</dd>
<dt class="field-even">type filter<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
<dt class="field-odd">returns ecg_peak_idxs<span class="colon">:</span></dt>
<dd class="field-odd"><p>ECG peak indices</p>
</dd>
<dt class="field-even">rtype ecg_peak_idxs<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray[int]</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resurfemg.preprocessing.ecg_removal.gating">
<span class="sig-prename descclassname"><span class="pre">resurfemg.preprocessing.ecg_removal.</span></span><span class="sig-name descname"><span class="pre">gating</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emg_raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_idxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gate_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">205</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resurfemg.preprocessing.ecg_removal.gating" title="Link to this definition">¶</a></dt>
<dd><p>Eliminate peaks (e.g. QRS) from emg_raw using gates
of width gate_width. The gate either filled by zeros or interpolation.
The filling method for the gate is encoded as follows:
0: Filled with zeros
1: Interpolation samples before and after
2: Fill with average of prior segment if exists
otherwise fill with post segment
3: Fill with running average of RMS (default)
—————————————————————————
:param emg_raw: Signal to process
:type emg_raw: ~numpy.ndarray
:param peak_idxs: list of individual peak index places to be gated
:type peak_idxs: ~list
:param gate_width: width of the gate
:type gate_width: int
:param method: filling method of gate
:type method: int</p>
<dl class="field-list simple">
<dt class="field-odd">Returns emg_raw_gated<span class="colon">:</span></dt>
<dd class="field-odd"><p>the gated result</p>
</dd>
<dt class="field-even">Rtype emg_raw_gated<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resurfemg.preprocessing.ecg_removal.wavelet_denoising">
<span class="sig-prename descclassname"><span class="pre">resurfemg.preprocessing.ecg_removal.</span></span><span class="sig-name descname"><span class="pre">wavelet_denoising</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emg_raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecg_peak_idxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_thresholding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelet_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'db2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resurfemg.preprocessing.ecg_removal.wavelet_denoising" title="Link to this definition">¶</a></dt>
<dd><p>Shrinkage Denoising using a-trous wavelet decomposition (SWT). NB: This
function assumes that the emg_raw has already been preprocessed for
removal of baseline, powerline, and aliasing. N.B. This is a Python
implementation of the SWT, as previously implemented in MATLAB by Jan
Graßhoff. See Copyright notice below.
————————————————————————–
Copyright 2019 Institute for Electrical Engineering in Medicine,
University of Luebeck
Jan Graßhoff</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the “Software”),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.
—————————————————————————
:param emg_raw: 1D raw EMG data
:type emg_raw: numpy.ndarray
:param ecg_peak_idxs: list of R-peaks indices
:type ecg_peak_idxs: numpy.ndarray
:param fs: Sampling rate of emg_raw
:type fs: int
:param hard_thresholding: True: hard (default), False: soft
:type hard_thresholding: bool
:param n: True: decomposition level (default: 4)
:type n: int
:param wavelet_type: wavelet type (default: ‘db2’, see pywt.swt help)
:type wavelet_type: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns emg_clean<span class="colon">:</span></dt>
<dd class="field-odd"><p>cleaned EMG signal</p>
</dd>
<dt class="field-even">Rtype emg_clean<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
<dt class="field-odd">Returns wav_dec<span class="colon">:</span></dt>
<dd class="field-odd"><p>wavelet decomposition</p>
</dd>
<dt class="field-even">Rtype wav_dec<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
<dt class="field-odd">Returns thresholds<span class="colon">:</span></dt>
<dd class="field-odd"><p>threshold values</p>
</dd>
<dt class="field-even">Rtype thresholds<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
<dt class="field-odd">Returns gate_bool_array<span class="colon">:</span></dt>
<dd class="field-odd"><p>gated signal based on R-peaks, where gate == 1</p>
</dd>
<dt class="field-even">Rtype gate_bool_array<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">resurfemg.preprocessing.ecg_removal module</a><ul>
<li><a class="reference internal" href="#resurfemg.preprocessing.ecg_removal.detect_ecg_peaks"><code class="docutils literal notranslate"><span class="pre">detect_ecg_peaks()</span></code></a></li>
<li><a class="reference internal" href="#resurfemg.preprocessing.ecg_removal.gating"><code class="docutils literal notranslate"><span class="pre">gating()</span></code></a></li>
<li><a class="reference internal" href="#resurfemg.preprocessing.ecg_removal.wavelet_denoising"><code class="docutils literal notranslate"><span class="pre">wavelet_denoising()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="resurfemg.preprocessing.html"
                          title="previous chapter">resurfemg.preprocessing package</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="resurfemg.preprocessing.envelope.html"
                          title="next chapter">resurfemg.preprocessing.envelope module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/resurfemg.preprocessing.ecg_removal.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="resurfemg.preprocessing.envelope.html" title="resurfemg.preprocessing.envelope module"
             >next</a> |</li>
        <li class="right" >
          <a href="resurfemg.preprocessing.html" title="resurfemg.preprocessing package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">resurfemg 1.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >resurfemg</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="resurfemg.html" >resurfemg package</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="resurfemg.preprocessing.html" >resurfemg.preprocessing package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">resurfemg.preprocessing.ecg_removal module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2022, e.oppersma@utwente.nl.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>